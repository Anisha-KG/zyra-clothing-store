<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Reward Coupons</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body {
      background-color: #f6e9e2;
      min-height: 100vh;
    }

    .breadcrumb-text {
      font-size: 14px;
      color: #6c6c6c;
    }

    .coupon-card {
      background-color: #fff;
      border: 2px solid #000;
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      transition: transform 0.2s;
      height: 100%;
    }

    .coupon-card:hover {
      transform: translateY(-5px);
    }

    .coupon-card img {
      width: 70px;
      margin-bottom: 15px;
    }

    /* FIXED COUPON CODE BOX */
    .coupon-code {
      background-color: #a79d9d;
      color: #000;
      border-radius: 8px;
      padding: 8px 12px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 10px;
      cursor: pointer;
      width: 100%;
    }

    .coupon-code span {
      flex: 1;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 15px;
    }

    .coupon-code i {
      flex-shrink: 0;
      font-size: 16px;
    }

    .coupon-code.used {
      background-color: #d3d3d3;
      cursor: not-allowed;
      opacity: 0.7;
    }

    .coupon-amount {
      font-size: 16px;
      font-weight: 600;
    }

    .used-text {
      color: red;
      font-size: 13px;
      font-weight: 600;
    }
  </style>
</head>

<body>

<%- include("../../views/partials/user/header") %>

<div class="container py-5">
  <div class="row">

    <!-- Sidebar -->
    <div class="col-md-3 mb-4">
      <%- include("../../views/partials/user/userProfile-sidebar") %>
    </div>

    <!-- Main Content -->
    <div class="col-md-9">

      <div class="breadcrumb-text mb-4">
        profile &nbsp;&gt;&nbsp; Rewards
      </div>

      <h4 class="text-center mb-4 fw-semibold">My Reward Coupons</h4>

      <!-- Coupons Grid -->
      <div class="row g-4">

        <% if (referralCoupons && referralCoupons.length > 0) { %>

          <% referralCoupons.forEach(coupon => { %>
            <div class="col-lg-3 col-md-4 col-sm-6 d-flex">
              <div class="coupon-card w-100">

                <img src="https://cdn-icons-png.flaticon.com/512/3081/3081559.png" alt="Gift">

                <div
                  class="coupon-code <%= coupon.isUsed ? 'used' : '' %>"
                  <% if (!coupon.isUsed) { %>
                    onclick="copyCoupon('<%= coupon.couponCode %>')"
                  <% } %>
                >
                  <span title="<%= coupon.couponCode %>">
                    <%= coupon.couponCode %>
                  </span>
                  <i class="bi bi-clipboard"></i>
                </div>

                <div class="coupon-amount">
                  â‚¹<%= coupon.discount %> OFF
                </div>

                <% if (coupon.isUsed) { %>
                  <div class="used-text mt-1">Used</div>
                <% } %>

              </div>
            </div>
          <% }) %>

        <% } else { %>

          <div class="col-12 text-center">
            <p class="fw-semibold text-muted">No reward coupons available</p>
          </div>

        <% } %>

      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
  function copyCoupon(code) {
    navigator.clipboard.writeText(code);
    alert("Coupon code copied: " + code);
  }
</script>

</body>
</html>
